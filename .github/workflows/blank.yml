name: ğŸ’€ CyberLexS Klinux Ultimate

on: 
  workflow_dispatch:
    inputs:
      duration:
        description: 'Sá»‘ giá» treo mÃ¡y (Max 6)'
        required: true
        default: '6'

jobs:
  kali-run:
    runs-on: ubuntu-latest
    timeout-minutes: 360
    steps:
      - name: ğŸš€ 1. Tá»‘i Æ°u Há»‡ thá»‘ng & BÄƒng thÃ´ng
        run: |
          sudo sysctl -w net.ipv4.tcp_congestion_control=bbr
          sudo apt-get update -q
          sudo apt-get install -y docker.io openssh-server -q

      - name: ğŸ›¡ï¸ 2. Káº¿t ná»‘i Tailscale
        uses: tailscale/github-action@v2
        with:
          authkey: ${{ secrets.TAILSCALE_AUTHKEY }}
          hostname: CyberLexS-Klinux

      - name: ğŸ‘¤ 3. Cáº¥u hÃ¬nh TÃ i khoáº£n & SSH
        run: |
          sudo useradd -m -s /bin/bash CyberLexS
          echo "CyberLexS:Nam12345" | sudo chpasswd
          sudo usermod -aG sudo CyberLexS
          sudo sed -i 's/#PasswordAuthentication yes/PasswordAuthentication yes/g' /etc/ssh/sshd_config
          sudo sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/g' /etc/ssh/sshd_config
          sudo service ssh restart

      - name: ğŸ´â€â˜ ï¸ 4. Khá»Ÿi táº¡o Klinux (Kali Docker)
        run: |
          sudo docker run -d --name klinux --network host -it kalilinux/kali-rolling /bin/bash
          # CÃ i sáºµn bá»™ cÃ´ng cá»¥ máº¡ng cÆ¡ báº£n cho Kali
          sudo docker exec klinux apt-get update -y
          sudo docker exec klinux apt-get install -y nmap curl net-tools iputils-ping -y

      - name: ğŸ“‹ 5. XUáº¤T THÃ”NG TIN ÄÄ‚NG NHáº¬P (Láº¤Y á» ÄÃ‚Y)
        run: |
          IP_ADDR=$(tailscale ip -4)
          echo -e "\n\033[1;32m=========================================="
          echo -e "ğŸš€ THÃ”NG TIN VPS KLINUX Cá»¦A Báº N"
          echo -e "=========================================="
          echo -e "ğŸ“ IP: $IP_ADDR"
          echo -e "ğŸ‘¤ USER: CyberLexS"
          echo -e "ğŸ”‘ PASS: Nam12345"
          echo -e "ğŸšª PORT: 22"
          echo -e "------------------------------------------"
          echo -e "âš¡ Lá»†NH VÃ€O KALI: sudo docker exec -it klinux /bin/bash"
          echo -e "==========================================\033[0m\n"

      - name: âš“ 6. Duy trÃ¬ káº¿t ná»‘i
        run: |
          HOURS=${{ github.event.inputs.duration }}
          echo "VPS Ä‘ang cháº¡y trong $HOURS giá»..."
          sleep $((HOURS * 3600))
